import { useRouter } from '@/i18n/routing';
import { ChevronDown, FileText, Layers, MessageSquare, Star, User, UserCheck } from 'lucide-react';
import { useTranslations } from 'next-intl';
import Image from 'next/image';
import React, { useEffect, useRef, useState } from 'react';

export default function ButtonIcon({ icon, href, cn }) {
    const router = useRouter();
	const t = useTranslations()
    const icons = {
        '/icons/pdf.png': (
            <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'>
                <path className={` stroke-[#757D8A] dark:stroke-white `} d='M19.75 7.75H15.25C14.9848 7.75 14.7304 7.64464 14.5429 7.45711C14.3554 7.26957 14.25 7.01522 14.25 6.75V2.25M19.75 7.75V20.75C19.75 21.0152 19.6446 21.2696 19.4571 21.4571C19.2696 21.6446 19.0152 21.75 18.75 21.75H5.25C4.98478 21.75 4.73043 21.6446 4.54289 21.4571C4.35536 21.2696 4.25 21.0152 4.25 20.75V3.25C4.25 2.98478 4.35536 2.73043 4.54289 2.54289C4.73043 2.35536 4.98478 2.25 5.25 2.25H14.25M19.75 7.75L14.25 2.25' stroke='#757D8A' strokelinecap='round' stroke-linejoin='round' />
                <path className={` stroke-[#757D8A] dark:stroke-white `} d='M17.2157 12.2675H14.9697V16.75M14.9697 14.5085H16.4352M6.78517 16.7415V12.2585H8.29367C8.69269 12.2584 9.07541 12.4167 9.35766 12.6988C9.6399 12.9809 9.79854 13.3635 9.79867 13.7625C9.7988 14.1615 9.64042 14.5442 9.35836 14.8265C9.07631 15.1087 8.69369 15.2674 8.29467 15.2675H6.78467M10.8772 16.75V12.25H11.6402C12.2369 12.25 12.8092 12.4871 13.2312 12.909C13.6531 13.331 13.8902 13.9033 13.8902 14.5C13.8902 15.0967 13.6531 15.669 13.2312 16.091C12.8092 16.5129 12.2369 16.75 11.6402 16.75H10.8772Z' stroke='#757D8A' strokelinecap='round' stroke-linejoin='round' />
            </svg>
        ),
        '/icons/copy.png': (
            <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'>
                <path className={`stroke-[#757D8A] dark:stroke-white `} d='M14 7C14 6.068 14 5.602 13.848 5.235C13.7475 4.99218 13.6001 4.77155 13.4143 4.58572C13.2284 4.3999 13.0078 4.25251 12.765 4.152C12.398 4 11.932 4 11 4H8C6.114 4 5.172 4 4.586 4.586C4 5.172 4 6.114 4 8V11C4 11.932 4 12.398 4.152 12.765C4.25251 13.0078 4.3999 13.2284 4.58572 13.4143C4.77155 13.6001 4.99218 13.7475 5.235 13.848C5.602 14 6.068 14 7 14' stroke='#757D8A' />
                <path className={`stroke-[#757D8A] dark:stroke-white `} d='M18 10H12C10.8954 10 10 10.8954 10 12V18C10 19.1046 10.8954 20 12 20H18C19.1046 20 20 19.1046 20 18V12C20 10.8954 19.1046 10 18 10Z' stroke='#757D8A' />
            </svg>
        ),
        '/icons/print.png': (
            <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'>
                <path className={`stroke-[#757D8A] dark:stroke-white `} d='M18 13.5H18.5C19.443 13.5 19.914 13.5 20.207 13.207C20.5 12.914 20.5 12.443 20.5 11.5V10.5C20.5 8.614 20.5 7.672 19.914 7.086C19.328 6.5 18.386 6.5 16.5 6.5H7.5C5.614 6.5 4.672 6.5 4.086 7.086C3.5 7.672 3.5 8.614 3.5 10.5V12.5C3.5 12.971 3.5 13.207 3.646 13.354C3.793 13.5 4.029 13.5 4.5 13.5H6' stroke='#757D8A' />
                <path className={`stroke-[#757D8A] dark:stroke-white `} d='M6.5 19.806V11.5C6.5 10.557 6.5 10.086 6.793 9.793C7.086 9.5 7.557 9.5 8.5 9.5H15.5C16.443 9.5 16.914 9.5 17.207 9.793C17.5 10.086 17.5 10.557 17.5 11.5V19.806C17.5 20.123 17.5 20.281 17.396 20.356C17.292 20.431 17.142 20.381 16.842 20.281L14.674 19.558C14.6191 19.5345 14.5606 19.5203 14.501 19.516C14.4415 19.5236 14.3837 19.5412 14.33 19.568L12.186 20.426C12.1279 20.4556 12.0649 20.4743 12 20.481C11.9351 20.4743 11.8721 20.4556 11.814 20.426L9.67 19.568C9.6166 19.5414 9.55915 19.5238 9.5 19.516C9.44004 19.52 9.3812 19.5342 9.326 19.558L7.158 20.281C6.858 20.381 6.708 20.431 6.604 20.356C6.5 20.281 6.5 20.123 6.5 19.806Z' stroke='#757D8A' />
                <path className={`stroke-[#757D8A] dark:stroke-white `} d='M9.5 13.5H13.5M9.5 16.5H14.5' stroke='#757D8A' strokelinecap='round' />
                <path className={`stroke-[#757D8A] dark:stroke-white `} d='M17.5 6.5V6.1C17.5 4.403 17.5 3.554 16.973 3.027C16.446 2.5 15.597 2.5 13.9 2.5H10.1C8.403 2.5 7.554 2.5 7.027 3.027C6.5 3.554 6.5 4.403 6.5 6.1V6.5' stroke='#757D8A' />
            </svg>
        ),
        '/icons/filter.png': (
            <svg width='23' height='22' viewBox='0 0 23 22' fill='none' xmlns='http://www.w3.org/2000/svg'>
                <path className={` fill-[#515161] dark:fill-white `} d='M17.4375 11C17.4375 11.1823 17.3651 11.3572 17.2361 11.4861C17.1072 11.6151 16.9323 11.6875 16.75 11.6875H5.75C5.56766 11.6875 5.3928 11.6151 5.26386 11.4861C5.13493 11.3572 5.0625 11.1823 5.0625 11C5.0625 10.8177 5.13493 10.6428 5.26386 10.5139C5.3928 10.3849 5.56766 10.3125 5.75 10.3125H16.75C16.9323 10.3125 17.1072 10.3849 17.2361 10.5139C17.3651 10.6428 17.4375 10.8177 17.4375 11ZM20.1875 6.1875H2.3125C2.13016 6.1875 1.9553 6.25993 1.82636 6.38886C1.69743 6.5178 1.625 6.69266 1.625 6.875C1.625 7.05734 1.69743 7.2322 1.82636 7.36114C1.9553 7.49007 2.13016 7.5625 2.3125 7.5625H20.1875C20.3698 7.5625 20.5447 7.49007 20.6736 7.36114C20.8026 7.2322 20.875 7.05734 20.875 6.875C20.875 6.69266 20.8026 6.5178 20.6736 6.38886C20.5447 6.25993 20.3698 6.1875 20.1875 6.1875ZM13.3125 14.4375H9.1875C9.00516 14.4375 8.8303 14.5099 8.70136 14.6389C8.57243 14.7678 8.5 14.9427 8.5 15.125C8.5 15.3073 8.57243 15.4822 8.70136 15.6111C8.8303 15.7401 9.00516 15.8125 9.1875 15.8125H13.3125C13.4948 15.8125 13.6697 15.7401 13.7986 15.6111C13.9276 15.4822 14 15.3073 14 15.125C14 14.9427 13.9276 14.7678 13.7986 14.6389C13.6697 14.5099 13.4948 14.4375 13.3125 14.4375Z' fill='#515161' />
            </svg>
        ),
        '/icons/replace.png': (
            <svg width='23' height='22' viewBox='0 0 23 22' fill='none' xmlns='http://www.w3.org/2000/svg'>
                <path className={` fill-[#515161] dark:fill-white `} d='M17.4873 16.0162C17.6156 16.145 17.6876 16.3195 17.6876 16.5013C17.6876 16.6831 17.6156 16.8576 17.4873 16.9864C17.3936 17.0784 15.1798 19.25 11.5 19.25C8.2868 19.25 5.95445 17.325 4.625 15.8254V17.875C4.625 18.0573 4.55257 18.2322 4.42364 18.3611C4.2947 18.4901 4.11984 18.5625 3.9375 18.5625C3.75516 18.5625 3.5803 18.4901 3.45136 18.3611C3.32243 18.2322 3.25 18.0573 3.25 17.875V13.75C3.25 13.5677 3.32243 13.3928 3.45136 13.2639C3.5803 13.1349 3.75516 13.0625 3.9375 13.0625H8.0625C8.24484 13.0625 8.4197 13.1349 8.54864 13.2639C8.67757 13.3928 8.75 13.5677 8.75 13.75C8.75 13.9323 8.67757 14.1072 8.54864 14.2361C8.4197 14.3651 8.24484 14.4375 8.0625 14.4375H5.26437C6.32312 15.7566 8.49219 17.875 11.5 17.875C14.5938 17.875 16.4964 16.0308 16.5153 16.0119C16.6448 15.8836 16.8199 15.812 17.0022 15.8128C17.1844 15.8136 17.3589 15.8868 17.4873 16.0162ZM19.0625 3.4375C18.8802 3.4375 18.7053 3.50993 18.5764 3.63886C18.4474 3.7678 18.375 3.94266 18.375 4.125V6.17461C17.0455 4.675 14.7132 2.75 11.5 2.75C7.82016 2.75 5.60641 4.92164 5.51359 5.01359C5.38436 5.14237 5.31158 5.31721 5.31126 5.49964C5.31094 5.68208 5.3831 5.85718 5.51187 5.98641C5.64065 6.11564 5.81549 6.18842 5.99793 6.18874C6.18036 6.18906 6.35546 6.1169 6.48469 5.98813C6.50359 5.96922 8.40625 4.125 11.5 4.125C14.5078 4.125 16.6769 6.24336 17.7356 7.5625H14.9375C14.7552 7.5625 14.5803 7.63493 14.4514 7.76386C14.3224 7.8928 14.25 8.06766 14.25 8.25C14.25 8.43234 14.3224 8.6072 14.4514 8.73614C14.5803 8.86507 14.7552 8.9375 14.9375 8.9375H19.0625C19.2448 8.9375 19.4197 8.86507 19.5486 8.73614C19.6776 8.6072 19.75 8.43234 19.75 8.25V4.125C19.75 3.94266 19.6776 3.7678 19.5486 3.63886C19.4197 3.50993 19.2448 3.4375 19.0625 3.4375Z' fill='#515161' />
            </svg>
        ),
        '/icons/eye.png': (
            <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'>
                <path className=' stroke-[#757D8A] dark:stroke-white ' d='M9 4.46005C9.97004 4.15186 10.9822 3.99667 12 4.00005C16.182 4.00005 19.028 6.50005 20.725 8.70405C21.575 9.81005 22 10.3611 22 12.0001C22 13.6401 21.575 14.1911 20.725 15.2961C19.028 17.5001 16.182 20.0001 12 20.0001C7.818 20.0001 4.972 17.5001 3.275 15.2961C2.425 14.1921 2 13.6391 2 12.0001C2 10.3601 2.425 9.80905 3.275 8.70405C3.7935 8.02688 4.37074 7.39677 5 6.82105' stroke='#757D8A' stroke-width='1.5' stroke-linecap='round' />
                <path className=' stroke-[#757D8A] dark:stroke-white ' d='M15 12C15 12.7956 14.6839 13.5587 14.1213 14.1213C13.5587 14.6839 12.7956 15 12 15C11.2044 15 10.4413 14.6839 9.87868 14.1213C9.31607 13.5587 9 12.7956 9 12C9 11.2044 9.31607 10.4413 9.87868 9.87868C10.4413 9.31607 11.2044 9 12 9C12.7956 9 13.5587 9.31607 14.1213 9.87868C14.6839 10.4413 15 11.2044 15 12Z' stroke='#757D8A' stroke-width='1.5' />
            </svg>
        ),
        '/icons/edit.png': (
            <svg width='24' height='24' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'>
                <path className=' stroke-[#757D8A] dark:stroke-white ' d='M15 6.00019L18 9.00019M13 20.0002H21M5 16.0002L4 20.0002L8 19.0002L19.586 7.41419C19.9609 7.03913 20.1716 6.53051 20.1716 6.00019C20.1716 5.46986 19.9609 4.96124 19.586 4.58619L19.414 4.41419C19.0389 4.03924 18.5303 3.82861 18 3.82861C17.4697 3.82861 16.9611 4.03924 16.586 4.41419L5 16.0002Z' stroke='#757D8A' stroke-linecap='round' stroke-linejoin='round' />
            </svg>
        ),
    };

    const [isOpen, setIsOpen] = useState(false);
    const handleClick = () => {
        href && router.push(href);

        if (icon === '/icons/filter.png') setIsOpen(!isOpen);
    };


	const selectRef = useRef(null);
	useEffect(() => {
	  const handleClickOutside = event => {
		if (selectRef.current && !selectRef.current.contains(event.target)) setIsOpen(false);
	  };
  
	  document.addEventListener('mousedown', handleClickOutside);
	  return () => document.removeEventListener('mousedown', handleClickOutside);
	}, []);


    return (
        <div onClick={handleClick} className={` ${cn} relative cursor-pointer group hover:bg-[#efefef] hover:dark:bg-bg3 duration-300 group w-[45px] h-[45px] flex items-center justify-center border-[1px] border-[#efefef] dark:border-border1 rounded-[6px]`}>
            <div className='hover:scale-[.97]'> {icons?.[icon]} </div>

            {isOpen && (
                <div ref={selectRef}>
                    <div className='absolute rtl:right-0 ltr:left-0 top-[100%] mt-2 w-48 bg-[#0b4a90] dark:bg-bg3 text-white rounded-[6px] shadow-lg p-2'>
                        <div> {t("filterBy")} </div>
                        <ul className='mt-[10px] ' >
                            <DropdownItem icon={<MessageSquare size={16} />} text='Unread' />
                            <DropdownItem icon={<Star size={16} />} text='Favorites' />
                            <DropdownItem icon={<User size={16} />} text='Contacts' />
                            {/* <DropdownItem icon={<UserCheck size={16} />} text='Non-contacts' />
                            <DropdownItem icon={<Layers size={16} />} text='Groups' />
                            <DropdownItem icon={<FileText size={16} />} text='Drafts' /> */}
                        </ul>
                    </div>
                </div>
            )}
        </div>
    );
}

function DropdownItem({ icon, text }) {
    return (
        <li className='flex items-center gap-[5px] px-3 py-2 hover:bg-[#084384] hover:shadow-md dark:hover:bg-bg4 rounded-md cursor-pointer'>
            {icon} <span className='ml-2'>{text}</span>
        </li>
    );
}
